<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Hyeon, Kim">
    <title>Dummy 2048</title>
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.1/normalize.min.css">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div id="app">
      <h1><small>Dummy</small> 2048</h1>

      <div id="grid">
        <table>
          <tr>
            <td><div id="0-0"></div></td>
            <td><div id="0-1"></div></td>
            <td><div id="0-2"></div></td>
            <td><div id="0-3"></div></td>
          </tr>
          <tr>
            <td><div id="1-0"></div></td>
            <td><div id="1-1"></div></td>
            <td><div id="1-2"></div></td>
            <td><div id="1-3"></div></td>
          </tr>
          <tr>
            <td><div id="2-0"></div></td>
            <td><div id="2-1"></div></td>
            <td><div id="2-2"></div></td>
            <td><div id="2-3"></div></td>
          </tr>
          <tr>
            <td><div id="3-0"></div></td>
            <td><div id="3-1"></div></td>
            <td><div id="3-2"></div></td>
            <td><div id="3-3"></div></td>
          </tr>
        </table>
      </div><!-- div#grid -->

      <p><small>Made by Hyeon, Kim</small></p>
    </div><!-- div#app -->

    <script src="http://code.jquery.com/jquery.min.js"></script>
    <script>
      'use strict';

      // Constants
      var direction = {
        left:  37,
        up:    38,
        right: 39,
        down:  40,
      };

      // makeGame() closure
      var makeGame = function(initial) {
        var grid = initial.slice(0);

        return {
          // game.forEach( function(row, col, value) { ... } );
          forEach: function(handler) {
            for (var row = 0; row < 4; ++row) for (var col = 0; col < 4; ++col) {
              handler(row, col, grid[row][col]);
            }
          },

          // game.move(game.left);
          // game.move(event.which);
          move: function(cmd) {
            switch(cmd) {
            case direction.left:
              console.log('왼쪽');
              break;
            case direction.right:
              console.log('오른쪽');
              break;
            case direction.up:
              console.log('위');
              break;
            case direction.down:
              console.log('아래');
              break;
            }
          },
        };
      };


      // UI controller
      $(function() {
        var game = makeGame([
          [0, 0, 0, 0],
          [2, 0, 0, 0],
          [0, 0, 0, 2],
          [0, 0, 0, 0],
        ]);

        var present = function() {
          game.forEach(function(row, col, value) {
            $('#'+row+'-'+col).text(value ? value : '');
          });
        };

        present();

        $(window).keydown(function(e) {
          e.preventDefault();

          game.move(e.which);
          present();
        });
      });
    </script>
  </body>
</html>
